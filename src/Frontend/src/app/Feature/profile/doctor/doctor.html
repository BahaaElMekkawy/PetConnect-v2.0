@if(typeof profileData() != 'undefined'){
<section
  class="w-100 p-4 min-vh-100"
  style="background-color: #eee; border-radius: 0.5rem 0.5rem 0 0"
>
  <div class="row" style="max-width: 2000px; margin: auto">
    <button
      class="btn btn-primary d-md-none mb-3"
      (click)="sidebarVisible = !sidebarVisible"
      aria-label="Toggle sidebar"
    >
      <i class="fas fa-bars"></i> Menu
    </button>
    <!-- Left Column: Doctor Profile Info -->
    <div
      class="col-lg-4 col-md-block d-md-block"
      [class.d-none]="!sidebarVisible"
    >
      <div class="card mb-4">
        <!-- Loading Spinner -->
        @if(loadingProfile()){
        <div class="text-center p-5">
          <div class="spinner-border text-primary" role="status"></div>
          <p class="mt-3">Loading profile...</p>
        </div>
        }

        <!-- No profile fallback -->
        @if(!loadingProfile() && !profileData()){
        <div class="alert alert-warning text-center">
          Unable to load profile information.
        </div>
        }

        <!-- Profile Card - Doctor's basic info -->
        @if(!loadingProfile() && profileData()){
        <div class="card-body p-0">
          <!-- <img
            [src]="
              getFullImageUrl(profileData().imgUrl) ||
              'assets/img/default-user.png'
            "
            alt="Doctor Avatar"
            class="rounded-circle img-fluid"
            style="width: 150px"
          /> -->
          <h5 class="my-3 px-3">Hey, {{ profileData().fName }}</h5>
          <!-- <p class="text-muted mb-1">{{ profileData().city }}</p>
          <p class="text-muted mb-4">
            <strong>{{ profileData().pricePerHour }}</strong> EGP/Hour
          </p> -->
          <div *ngIf="doctor().isApproved" class="list-group p=0 m-0">
            <a
              routerLink="/doc-profile/appointments"
              routerLinkActive="active"
              [routerLinkActiveOptions]="{ exact: true }"
              class="list-group-item list-group-item-action d-flex align-items-center gap-3"
              (click)="sidebarVisible = !sidebarVisible"
            >
              <i class="fas fa-calendar-check text-primary"></i>
              Appointments
            </a>

            <a
              routerLink="/doc-profile/blogs"
              routerLinkActive="active"
              class="list-group-item list-group-item-action d-flex align-items-center gap-3"
              (click)="sidebarVisible = !sidebarVisible"
            >
              <i class="fas fa-blog text-primary"></i>
              Blogs
            </a>

            <a
              [routerLink]="['/doc-profile/add-time-slots', profileData().id]"
              routerLinkActive="active"
              class="list-group-item list-group-item-action d-flex align-items-center gap-3"
              (click)="sidebarVisible = !sidebarVisible"
            >
              <i class="fas fa-plus-circle text-primary"></i>
              Add Timeslot
            </a>

            <a
              [routerLink]="['/doc-profile/timeslots', profileData().id]"
              routerLinkActive="active"
              class="list-group-item list-group-item-action d-flex align-items-center gap-3"
              (click)="sidebarVisible = !sidebarVisible"
            >
              <i class="fas fa-clock text-primary"></i>
              Show Timeslots
            </a>
          </div>
        </div>
        }
      </div>

      <!-- Doctor's Detailed Information -->
      <div class="card mb-4 mt-3">
        @if(!loadingProfile() && profileData()){
        <div class="card-body">
          <div class="row">
            <div class="col-sm-3">
              <p class="mb-0">Full Name</p>
            </div>
            <div class="col-sm-9">
              <p class="text-muted mb-0">
                {{ profileData().fName }} {{ profileData().lName }}
              </p>
            </div>
          </div>
          <hr />
          <div class="row">
            <div class="col-sm-3">
              <p class="mb-0">Gender</p>
            </div>
            <div class="col-sm-9">
              <p class="text-muted mb-0">{{ profileData().gender }}</p>
            </div>
          </div>
          <hr />
          <div class="row">
            <div class="col-sm-3">
              <p class="mb-0">Specialty</p>
            </div>
            <div class="col-sm-9">
              <p class="text-muted mb-0">{{ profileData().petSpecialty }}</p>
            </div>
          </div>
          <hr />
          <div class="row">
            <div class="col-sm-3">
              <p class="mb-0">Address</p>
            </div>
            <div class="col-sm-9">
              <p class="text-muted mb-0">
                {{ profileData().street }}, {{ profileData().city }}
              </p>
            </div>
          </div>
          <hr />
          <div class="row">
            <div class="col-sm-3">
              <p class="mb-0">Certificate</p>
            </div>
            <div class="col-sm-9">
              <p class="text-muted mb-0">
                <a
                  [href]="getFullImageUrl(profileData().certificateUrl)"
                  target="_blank"
                  class="text-decoration-underline"
                  >View Certificate</a
                >
              </p>
            </div>
          </div>
          <hr />
          <div class="row">
            <div class="col-sm-3">
              <p class="mb-0">ID Card</p>
            </div>
            <div class="col-sm-9">
              <p class="text-muted mb-0">
                <a
                  [href]="getFullImageUrl(profileData().idCardUrl)"
                  target="_blank"
                  class="text-decoration-underline"
                  >View ID Card
                </a>
              </p>
            </div>
          </div>
          <hr />
          <div class="row">
            <div class="col-sm-3">
              <p class="mb-0">Approved</p>
            </div>
            <div class="col-sm-9">
              <p class="mb-0">
                <span
                  class="badge"
                  [ngClass]="
                    profileData().isApproved ? 'bg-success' : 'bg-danger'
                  "
                >
                  {{ profileData().isApproved ? "Yes" : "No" }}
                </span>
              </p>
            </div>
          </div>
        </div>
        <button
          type="button"
          class="btn btn-primary mt-4"
          [routerLink]="['/doctors', 'update', profileData().id]"
        >
          Update Profile
        </button>
        }
      </div>
    </div>
    <div class="col-lg-8">
      <ng-container *ngIf="doctor().isApproved && !loading">
        <router-outlet></router-outlet>
      </ng-container>

      <div *ngIf="!doctor().isApproved && !loading">
        <div class="card border-danger shadow-sm text-center mt-5">
          <div class="card-header bg-danger text-white">Access Denied</div>
          <div class="card-body">
            <h4>You're not approved yet.</h4>

            <p class="card-text mt-3">
              Our team will review your profile and get back to you soon!
              <br />Please contact <a routerLink="/contact">Support</a> for
              assistance.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Column: Appointment Requests -->
  </div>
</section>
}
