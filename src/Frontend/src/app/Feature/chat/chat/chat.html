<div class="container-fluid px-3 py-0" style="height: 100vh">
  <div class="row h-100 border rounded shadow-sm">
    <!-- Left Sidebar: Chat Contacts -->
    <div class="col-md-3 border-end overflow-auto" style="height: 100%">
      <h5 class="text-uppercase fw-bold p-3 border-bottom">Messages</h5>
      <div class="list-group list-group-flush">
        <div
          class="list-group-item d-flex align-items-start"
          (click)="activateContact(contact)"
          *ngFor="let contact of contacts"
        >
          <img
            [src]="getFullImageUrl(contact.imageURL)"
            class="rounded-circle me-2"
            width="40"
            height="40"
          />
          <div>
            <div class="fw-semibold">
              {{ contact.receiverName }}
            </div>
            <small class="text-muted">{{ contact.lastMessage }}</small>
          </div>
        </div>
      </div>
    </div>

    <!-- Middle Content: Chat Window -->
    <div class="col-md-6 d-flex flex-column p-0" style="height: 100%">
      <div class="border-bottom p-3 bg-light">
        <h5 class="mb-0">{{ activeContact?.receiverName }}</h5>
      </div>

      <!-- Message History -->
      <div
        class="flex-grow-1 overflow-auto p-3"
        style="background-color: #f9f9f9"
      >
        <!-- Repeat messages -->
        <div
          *ngFor="let msg of messages"
          class="mb-2 d-flex"
          [ngClass]="{
            'justify-content-end': msg.receiverId === receiverId,
            'justify-content-start': msg.receiverId !== receiverId
          }"
        >
          <div
            class="p-2 rounded"
            [ngClass]="{
              'text-white bg-primary ': msg.receiverId === receiverId,
              'text-white bg-dark ': msg.receiverId !== receiverId
            }"
            style="max-width: 75%; white-space: pre-wrap"
          >
            <div class="fw-semibold mb-1">
              {{ msg.receiverId === receiverId ? "You" : msg.senderId }}
            </div>
            <div>{{ msg.message }}</div>
            <div class="text-end small text-muted mt-1">Just now</div>
          </div>
        </div>
      </div>

      <!-- Input Area -->
      <div class="p-3 border-top bg-white">
        <!-- <div class="mb-2">
          <input
            [(ngModel)]="receiverId"
            class="form-control"
            placeholder="Receiver ID (user ID)"
          />
        </div> -->
        <div class="input-group">
          <input
            [(ngModel)]="message"
            class="form-control"
            placeholder="Type a message..."
          />
          <button class="btn btn-outline-secondary" type="button">ðŸ“Ž</button>
          <button class="btn btn-primary" (click)="sendMessage()">Send</button>
        </div>
      </div>
    </div>

    <!-- Right Sidebar: Customer Info -->
    <div class="col-md-3 border-start p-3 d-none d-md-block">
      <div class="text-center">
        <img
          [src]="getFullImageUrl(activeContact?.imageURL || '')"
          class="rounded-circle mb-2"
          style="max-width: 60px"
          alt="User"
        />
        <h6 class="fw-bold">{{ activeContact?.receiverName }}</h6>
        <p class="text-muted mb-1">{{ activeContact?.receiverName }}</p>
        <span
          class="badge"
          [ngClass]="activeContact?.isOnline ? 'bg-success' : 'bg-secondary'"
        >
          {{ activeContact?.isOnline ? "Online" : "Offline" }}
        </span>
      </div>
      <hr />
      <p class="small text-muted">
        John's info will go here like bio, recent activity, etc.
      </p>
    </div>
  </div>
</div>
