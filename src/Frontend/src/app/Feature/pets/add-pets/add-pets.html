<section id="hero" class="hero-section">
  <div class="hero-background">
    <div class="hero-overlay"></div>
    <div class="container hero-content">
      <div class="hero-text">
        <h1 class="hero-title">Add New Pet</h1>
        <p class="hero-subtitle">Help a furry friend find their forever home</p>
        <div class="hero-buttons">
          <a routerLink="/pets" class="btn btn-outline-light">
            <i class="fas fa-paw"></i> All Pets
          </a>
          <a routerLink="/doctors" class="btn btn-outline-light">
            <i class="fas fa-user-md"></i> Our Vets
          </a>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Form Section -->
<section class="form-section">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-8 col-md-10">
        <div class="form-card">
          <div class="form-header">
            <h3 class="form-title">Pet Information</h3>
            <p class="form-subtitle">Please fill in all the details about the pet</p>
          </div>

          <form #form="ngForm" (ngSubmit)="onSubmit(form)" enctype="multipart/form-data" novalidate class="pet-form">

            <!-- Pet Name -->
            <div class="form-group">
              <label class="form-label">
                <i class="fas fa-tag"></i>
                Pet Name
              </label>
              <div class="input-wrapper">
                <input type="text" name="name" class="form-input" [(ngModel)]="pet.Name" #name="ngModel" required
                  minlength="3" maxlength="20" placeholder="Enter pet's name" />
                <div class="input-icon">
                  <i class="fas fa-heart"></i>
                </div>
              </div>
              <div class="error-messages">
                <span *ngIf="name.errors?.['required'] && (name.dirty || name.touched)" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  Pet name is required
                </span>
                <span *ngIf="name.errors?.['minlength'] && (name.dirty || name.touched)" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  Name must be at least 3 characters
                </span>
                <span *ngIf="name.errors?.['maxlength'] && (name.dirty || name.touched)" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  Name cannot exceed 20 characters
                </span>
                <span *ngIf="backendErrors['Name']" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  {{ backendErrors["Name"][0] }}
                </span>
              </div>
            </div>
            <div class="form-group">
              <label for="categoryList" class="form-label">
                <i class="fas fa-list"></i>
                Category
              </label>
              <div class="select-wrapper">
                <select class="form-select" id="categoryList" [(ngModel)]="selectedCategoryId" name="category"
                  #category="ngModel" (change)="onCategoryChange($event)" required>
                  <option value="0" selected>-- Select Category --</option>
                  <option *ngFor="let cat of categories" [value]="cat.id">
                    {{ cat.name }}
                  </option>
                </select>
                <div class="select-icon">
                  <i class="fas fa-chevron-down"></i>
                </div>
              </div>
              <div class="error-messages">
                <span *ngIf="category.value == '0' && category.touched" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  Category is required
                </span>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">
                <i class="fas fa-dna"></i>
                Breed
              </label>
              <div class="select-wrapper">
                <select class="form-select" name="breedId" [(ngModel)]="pet.BreedId" #breedId="ngModel"
                  [disabled]="selectedCategoryId === 0" required>
                  <option value="0" disabled>
                    {{ selectedCategoryId === 0 ? "Select a category first" : "Select a breed" }}
                  </option>
                  <option *ngFor="let breed of filteredBreeds" [value]="breed.id">
                    {{ breed.name }}
                  </option>
                </select>
                <div class="select-icon">
                  <i class="fas fa-chevron-down"></i>
                </div>
              </div>
              <div class="error-messages">
                <span *ngIf="breedId.value == '0' && breedId.touched" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  Breed selection is required
                </span>
                <span *ngIf="backendErrors['BreedId']" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  {{ backendErrors["BreedId"][0] }}
                </span>
              </div>
            </div>

            <!-- Status -->
            <div class="form-group">
              <label class="form-label">
                <i class="fas fa-info-circle"></i>
                Status
              </label>
              <div class="select-wrapper">
                <select class="form-select" name="status" [(ngModel)]="pet.Status" #status="ngModel" required>
                  <option value="">-- Select Status --</option>
                  <option *ngFor="let status of statusOptions" [value]="status.key">
                    {{ status.value }}
                  </option>
                </select>
                <div class="select-icon">
                  <i class="fas fa-chevron-down"></i>
                </div>
              </div>
              <div class="error-messages">
                <span *ngIf="status.invalid && (status.dirty || status.touched)" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  Status is required
                </span>
                <span *ngIf="backendErrors['Status']" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  {{ backendErrors["Status"][0] }}
                </span>
              </div>
            </div>

            <!-- Age -->
            <div class="form-group">
              <label class="form-label">
                <i class="fas fa-birthday-cake"></i>
                Age (years)
              </label>
              <div class="input-wrapper">
                <input type="number" name="Age" class="form-input" [(ngModel)]="pet.Age" #Age="ngModel" required min="0"
                  max="50" placeholder="Enter pet's age" />
                <div class="input-icon">
                  <i class="fas fa-calendar-alt"></i>
                </div>
              </div>
              <div class="error-messages">
                <span *ngIf="Age.errors?.['required'] && (Age.dirty || Age.touched)" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  Age is required
                </span>
                <span *ngIf="Age.errors?.['min'] && (Age.dirty || Age.touched)" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  Age must be at least 0
                </span>
                <span *ngIf="Age.errors?.['max'] && (Age.dirty || Age.touched)" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  Age must be less than or equal to 50
                </span>
                <span *ngIf="backendErrors['Age']" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  {{ backendErrors["Age"][0] }}
                </span>
              </div>
            </div>

            <!-- Image Upload -->
            <div class="form-group">
              <label class="form-label">
                <i class="fas fa-camera"></i>
                Pet Photo
              </label>
              <div class="file-upload-wrapper">
                <input type="file" class="file-input" id="petImage" (change)="onFileChange($event)" accept="image/*" />
                <label for="petImage" class="file-upload-label">
                  <div class="file-upload-content">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <span class="file-upload-text">Choose a photo or drag it here</span>
                    <span class="file-upload-subtext">PNG, JPG up to 5MB</span>
                  </div>
                </label>
              </div>
              <div class="error-messages">
                <span *ngIf="imageError" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  {{ imageError }}
                </span>
              </div>
            </div>
            <!-- Description -->
            <div class="form-group">
              <label class="form-label">
                <i class="fas fa-edit"></i>
                Description / Notes
              </label>
              <div class="textarea-wrapper">
                <textarea name="Notes" class="form-textarea" [(ngModel)]="pet.Notes" #notes="ngModel" required
                  minlength="3" maxlength="100"
                  placeholder="Tell us about this pet's personality, special needs, or any other important information..."
                  rows="4"></textarea>
                <div class="textarea-counter">
                  <span class="counter-text">{{ pet.Notes?.length || 0 }}/100</span>
                </div>
              </div>
              <div class="error-messages">
                <span *ngIf="notes.errors?.['required'] && (notes.dirty || notes.touched)" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  Description is required
                </span>
                <span *ngIf="notes.errors?.['minlength'] && (notes.dirty || notes.touched)" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  Description must be at least 3 characters
                </span>
                <span *ngIf="notes.errors?.['maxlength'] && (notes.dirty || notes.touched)" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  Description cannot exceed 100 characters
                </span>
                <span *ngIf="backendErrors['Notes']" class="error-message">
                  <i class="fas fa-exclamation-circle"></i>
                  {{ backendErrors["Notes"][0] }}
                </span>
              </div>
            </div> <!-- Form Actions -->
            <div class="form-actions">
              <button type="submit" class="btn btn-primary" [disabled]="form.invalid">
                <i class="fas fa-save"></i>
                Save Pet
              </button> <a routerLink="/pets" class="btn btn-secondary">
                <i class="fas fa-times"></i>
                Cancel
              </a>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>